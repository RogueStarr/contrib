# apps/kube-system/cilium/values.yaml
cilium:
  kubeProxyReplacement: true
  l7Proxy: true
  ingressController:
    enabled: true

  # === IPAM: KUBERNETES MODE (DEFAULT) ===
  ipam:
    mode: kubernetes

  # === GATEWAY API ===
  gatewayAPI:
    enabled: true

  # === L2 LOAD BALANCING ===
  loadBalancer:
    mode: dsr
    algorithm: maglev
    acceleration: native
    l2:
      enabled: true

  # === EXTERNAL IP SUPPORT ===
  externalIPs:
    enabled: true
  nodeLocalExternalIP:
    enabled: true

  # === SECURITY CONTEXT ===
  securityContext:
    capabilities:
      ciliumAgent:
        - CHOWN
        - KILL
        - NET_ADMIN
        - NET_RAW
        - IPC_LOCK
        - SYS_ADMIN
        - SYS_RESOURCE
        - DAC_OVERRIDE
        - FOWNER
        - SETUID
        - SETGID

  # === HUBBLE ===
  hubble:
    relay:
      enabled: true
    ui:
      enabled: true
      service:
        annotations:
          omni-kube-service-exposer.sidero.dev/port: "50080"
          omni-kube-service-exposer.sidero.dev/label: Hubble

  # === NATIVE ROUTING ===
  routingMode: native
  autoDirectNodeRoutes: true